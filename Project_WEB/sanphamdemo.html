<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <link rel="stylesheet" href="index.css" type="text/css" />
    <script>
        function show() {
            var arr = JSON.parse(localStorage.getItem("products"));
            var tr =
                "<tr><th>ID</th><th>CUSTOMER</th><th>ID_RECEIPT</th><th>PRICE</th><th>ACTION</th></tr>";
            document.getElementById("showlist").innerHTML = tr;
        }

        function thongbaobox(namedelete) {
            document.getElementById("boxtb").style.animation = "tb 1s forwards";
            document.getElementById("boxtb").innerHTML =
                '<h1 style="margin-left:20px">XÁC NHẬN XÓA:</h1><a href="#" style="margin-left:40px;line-height:50px" onclick="deletee(\'' +
                namedelete +
                '\')"><h2 >YES</h2></a><a href="#" style="margin-left:60px;line-height:50px" onclick="invthongbaobox()"><h2>NO</h2></a>';
        }

        function deletee(namedelete) {
            //Xóa một sản phẩm
            var arr = JSON.parse(localStorage.getItem("products"));
            for (var i = 0; i < arr.length; i++) {
                if (arr[i].product == namedelete) {
                    arr.splice(i, 1);
                }
            }
            localStorage.setItem("products", JSON.stringify(arr));
            document.getElementById("boxtb").style.animation = "tb_2 1s forwards";
            show();
        }
        function addproduct() {
            //Thêm 1 sản phẩm
            var cut = document.getElementById("imgg").value.split("\\");
            var productArray = JSON.parse(localStorage.getItem("products"));
            var productadd = {
                product: document.getElementById("product").value,
                name: document.getElementById("name").value,
                brand: document.getElementById("brand").value,
                gender: document.getElementById("gender").value,
                img: cut[2],
                price: document.getElementById("price").value,
            };
            if (
                productadd.product == "" ||
                productadd.name == "" ||
                productadd.brand == "" ||
                productadd.gender == "" ||
                productadd.price == ""
            ) {
                alert("Hãy nhập đầy đủ thông tin");
                return 0;
            }
            for (var i = 0; i < productArray.length; i++)
                if (productadd.product == productArray[i].product) {
                    alert("ID sản phẩm đã tồn tại");
                    return 0;
                }
            productArray.push(productadd);
            localStorage.setItem("products", JSON.stringify(productArray));
            alert("Thêm thành công");
            reset_1(); //Reset lại thông tin điền trong box add sản phẩm
            show(); //Reset lại trang
        }
        var today = new Date();
        var date = today.getDate() + '/' + (today.getMonth() + 1) + '/' + today.getFullYear();
        var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
        var dateTime = date + ' ' + time;

        function layttHD() { //Lấy thông tin được điền vào từ phiếu hóa đơn

            if (localStorage.getItem("HDKH") == null) {
                var arr = [];
                localStorage.setItem('HDKH', JSON.stringify(arr));
            }
            if (CheckHD()) {
                var arrHD = JSON.parse(localStorage.getItem('HDKH'));
                var gioitinh, thanhtoanpt;
                var kh = {
                    gt: document.getElementById('nngioitinh').value,
                    tt: document.getElementById('pttt').value
                }
                switch (kh.gt) { //Kiểm tra giá trị chọn của các option về giới tính ở điền hóa đơn
                    case '0':
                        gioitinh = 'Male';
                        break;
                    case '1':
                        gioitinh = 'Female';
                        break;
                    case '2':
                        gioitinh = "Unknown";
                        break;
                    default:
                        break;

                }
                switch (kh.tt) { //Kiểm tra option phương thức thanh toán
                    case '1':
                        thanhtoanpt = 'VisaCard';
                        break;
                    case '2':
                        thanhtoanpt = 'Paypal';
                        break;
                    case '3':
                        thanhtoanpt = 'InternetBanking';
                        break;
                    case '4':
                        thanhtoanpt = 'Cash';
                        break;
                    default:
                        break;
                }
                var IDHD = 1;
                var chitiethoadon = JSON.parse(localStorage.getItem('cart'));
                var userr = JSON.parse(localStorage.getItem('buybyuser')); //local để xác định username nào đang đăng nhập
                for (var i = 0; i < arrHD.length; i++) {
                    if (IDHD == arrHD[i].IDhd) IDHD++;
                }
                var arr = { IDhd: IDHD, TK: userr[0].user, timehd: dateTime, tenkh: document.getElementById('nnhoten').value, sdtkh: document.getElementById('nnsdt').value, mailkh: document.getElementById('nnmail').value, tpkh: document.getElementById('nncity').value, diachikh: document.getElementById('nndiachi').value, ngaysinhkh: document.getElementById('nnngaysinh').value, pttt: thanhtoanpt, gioitinhkh: gioitinh, note: document.getElementById('note').value, tthd: "Chưa xử lý", cthoadon: chitiethoadon, tongtienhd: total() };
                arrHD.push(arr);
                localStorage.setItem('HDKH', JSON.stringify(arrHD));
                alert("Đặt hàng thành công !");
                reset();
            }
        }

        function checkQuantity(temp) {
            var s = 0;
            var arr = JSON.parse(localStorage.getItem('cart'));
            for (var i = 0; i < arr.length; i++)
                if (temp == arr[i].product) s++;
            return s;
        }

        function deletecart(namedelete) { //Xóa sản phẩm khỏi giỏ hàng
            var arr = JSON.parse(localStorage.getItem('cart'));
            for (var i = 0; i < arr.length; i++) {
                if (namedelete == arr[i].product) {
                    if (confirm('Bạn có chắc muốn xóa sản phẩm khỏi giỏ hàng?')) {
                        arr.splice(i, 1);
                        for (j = i; j < arr.length; j++) {
                            if (namedelete == arr[j].product) {
                                arr.splice(j, 1);
                                break;
                            }
                        }
                    }
                }

            }
            localStorage.setItem('cart', JSON.stringify(arr));
            window.location.reload();
        }

        function reloadHD() {
            window.location.reload();
        }
        var mid_2 = 0;

        function checkQuantity_2(temp, temp_1) {
            var s = 0;
            var arr = JSON.parse(localStorage.getItem('HDKH'));
            for (var i = 0; i < arr.length; i++)
                if (arr[i].IDhd == temp_1) {
                    for (var j = 0; j < arr[i].cthoadon.length; j++) {
                        if (temp == arr[i].cthoadon[j].product) {
                            s++;
                            mid_2 = arr[i].cthoadon[j].product;
                        }
                    }
                    break;
                }
            return s;
        }

        function showcthd_2(temp) { //Xuất chi tiết hóa đơn của từng hóa đơn
            var tr = "";
            var arrs = JSON.parse(localStorage.getItem('HDKH'));
            for (var i = 0; i < arrs.length; i++) {
                if (temp == arrs[i].IDhd) {
                    tr += '<tr><th>ID hóa đơn</th><th>IDSP</th><th>name</th><th>Brand</th><th>Img</th><th>Quantity</th><th>Price<a onclick="bill()" style="color:red;background-color:white;padding:0px 8px;border-radius:50%;cursor:pointer;margin-left:20px">-</a></th></tr>';
                    for (var j = 0; j < arrs[i].cthoadon.length; j++) {
                        if (mid_2 == arrs[i].cthoadon[j].product) continue;
                        else {
                            tr += '<tr><td>' + arrs[i].IDhd + '</td><td>' + arrs[i].cthoadon[j].product + '</td><td>' + arrs[i].cthoadon[j].name + '</td><td>' + arrs[i].cthoadon[j].brand + '</td><td><img src="' + arrs[i].cthoadon[j].img + '" style="width:80px;height:80px"/></td><td>' + checkQuantity_2(arrs[i].cthoadon[j].product, arrs[i].IDhd) + '</td><td>' + arrs[i].cthoadon[j].price + '$</td></tr>';
                        }
                    }
                    break;
                }

            }
            document.getElementById('dssp').innerHTML = tr;
        }

        function bill() { //Xem lại các hóa đơn mà username này đã đặt
            var arrs = JSON.parse(localStorage.getItem('HDKH'));
            var arr = JSON.parse(localStorage.getItem('buybyuser'));
            var tr = '<tr><th>ID hóa đơn</th><th>Tên người mua(Account đặt hàng)</th><th>Thời gian đặt hàng</th><th>SĐT</th><th>Địa chỉ</th><th>Gmail</th><th>PTTT</th><th>NOTE</th><th>Tổng tiền</th></tr>';
            for (var i = 0; i < arrs.length; i++) {
                if (arrs[i].TK == arr[0].user) {
                    tr += '<tr><td>' + arrs[i].IDhd + '</td><td>' + arrs[i].tenkh + '(' + arrs[i].TK + ')</td><td>' + arrs[i].timehd + '</td><td>' + arrs[i].sdtkh + '</td><td>' + arrs[i].diachikh + ' ' + arrs[i].tpkh + '</td><td>' + arrs[i].mailkh + '</td><td>' + arrs[i].pttt + '</td><td>' + arrs[i].note + '</td><td>' + arrs[i].tongtienhd + '$<a onclick="showcthd_2(' + arrs[i].IDhd + ')" style="color:red;background-color:white;padding:3px 8px;border-radius:50%;cursor:pointer;margin-left:20px;font-weight:bold">+</a></td></tr>';
                }
            }
            document.getElementById('dssp').innerHTML = tr;
        }

        function cartofuser() { //Lấy dữ liệu từ local cart để inner các sản phẩm vào trong giỏ
            var s = "",
                temp;
            var arr = JSON.parse(localStorage.getItem('cart'));
            for (var i = 0; i < arr.length; i++) {
                temp = 0;
                for (var j = i - 1; j >= 0; j--) {
                    if (arr[i].product == arr[j].product) {
                        temp = 1;
                        break;
                    }
                }
                if (temp == 1) continue;
                s += '<tr><td><div class="cart-info"><img style="width:100px;height:100px" src="' + arr[i].img + '" alt="" /><div style="font-size:23px"><p>' + arr[i].name + '</p><small>Price:$' + arr[i].price + '</small><br/><a href="#" onclick="deletecart(\'' + arr[i].product + '\')" style="font-size:19px">Remove</a></div></div></td><td>' + arr[i].product + '</td><td><input readOnly=true value="' + checkQuantity(arr[i].product) + '" /></td><td>$' + arr[i].price + '</td></tr>';
            }
            s = '<tr><th>Product</th><th>ID Product</th><th>Quantity</th><th>Subtotal</th></tr>' + s;
            document.getElementById('dssp').innerHTML = s;
        }

        function total() { //Tính tổng giá các sản phẩm của hóa đơn (kèm tax 10%)
            var totalprice = 0.0;
            var pricenottax = 0.0;
            var s = "";
            var arr = JSON.parse(localStorage.getItem('cart'));
            for (var i = 0; i < arr.length; i++) {
                pricenottax += arr[i].price;
            }
            totalprice = Math.ceil(pricenottax * 110 / 100);
            s = '<tr><td>Subtotal</td><td>$' + Math.ceil(pricenottax, 2) + '</td></tr><tr><td>Tax</td><td>10%</td></tr><tr><td>Total</td><td>$' + totalprice + '</td></tr>'
            document.getElementById('totalHoaDon').innerHTML = s;
            return totalprice;
        }

        function outHD() {
            document.getElementById('hoadon').style.zIndex = "-1";
            document.getElementById('hoadon').style.opacity = "0";
            document.getElementById('logbox_0').style.zIndex = "-1";
            document.getElementById('logbox_0').style.opacity = "0";
        }

        function hienHD() {
            document.getElementById('logbox_0').style.zIndex = "14";
            document.getElementById('logbox_0').style.opacity = "0.2";
            document.getElementById('hoadon').style.zIndex = "15";
            document.getElementById('hoadon').style.opacity = "1";
        }

        function reset() {
            document.getElementById('nnhoten').value = "";
            document.getElementById('nnsdt').value = "";
            document.getElementById('nnmail').value = "";
            document.getElementById('nncity').value = "";
            document.getElementById('nndiachi').value = "";
            document.getElementById('note').value = "";
            document.getElementById('nnngaysinh').value = "";
            document.getElementById('pttt').value = "";
            document.getElementById('nngioitinh').value = "";
        }

        function CheckHD() { //Kiểm tra hóa đơn đã điền đủ thông tin
            if (document.getElementById('nnhoten').value == "" ||
                document.getElementById('nnsdt').value == "" ||
                document.getElementById('nnmail').value == "" ||
                document.getElementById('nncity').value == "" ||
                document.getElementById('nndiachi').value == "" ||
                document.getElementById('nnsdt').value == "" ||
                document.getElementById('pttt').value == "" ||
                document.getElementById('nngioitinh').value == "") {
                alert('Hãy điền đầy đủ thông tin hóa đơn');
                return false;
            } else return true;
        }

        function invthongbaobox() {
            document.getElementById('boxtb').style.animation = "tb_2 1s forwards";
        }
        var count = 0;

        function invinbox() {
            if (count == 0) {

                document.getElementById('nav').style.animation = "navside_2 2s forwards";
                document.getElementById('shows').style.animation = "full 2s forwards";
                count++;
                return 0;
            }
            if (count == 1) {

                document.getElementById('nav').style.animation = "navside 2s forwards";
                document.getElementById('shows').style.animation = "full_2 2s forwards";
                count++;
                return 0;
            }
            if (count == 2) {
                count = 0;
                invinbox();
            }
        }
        var myIndex = 0;

        function slider() {
            var i;
            var x = document.getElementsByClassName("slideimg");
            for (i = 0; i < x.length; i++) {
                x[i].style.display = "none";
            }
            myIndex++;
            if (myIndex > x.length) { myIndex = 1 }
            x[myIndex - 1].style.display = "block";
            setTimeout(slider, 2000);
        }

        function checkGioHang() {
            var arr = JSON.parse(localStorage.getItem('cart'));
            if (localStorage.getItem('cart') == null || arr[0] == null)
                alert("Giỏ hàng trống");
            else window.location.assign('cart.html');
        }

        function createNewAccount() {
            var userArray = JSON.parse(localStorage.getItem('user'));
            var member = { username: document.getElementById('username').value, password: document.getElementById('password').value, fullname: document.getElementById('fullname').value, usertype: "member", email: document.getElementById('email').value, phone: document.getElementById('phone').value, address: document.getElementById('address').value };
            if (check(member)) {
                userArray.push(member);
                localStorage.setItem('user', JSON.stringify(userArray));
                alert("Đăng ký thành công");
                window.location.assign("DOAN.html");
            }
        }

        function createAdmin() {
            var userArray = [];
            if (localStorage.getItem('user') == null) {
                var user1 = { username: 'admin', password: 'admin', fullname: 'Admin', usertype: 'admin', email: '###', phone: '###', address: "###" };
                userArray.push(user1);
                console.log(userArray);
                localStorage.setItem('user', JSON.stringify(userArray));
            }
        }

        function check(obj) { //Check thông tin đăng ký
            var userArray = JSON.parse(localStorage.getItem('user'));
            for (var i = 0; i < userArray.length; i++) {
                if (obj.username == userArray[i].username && obj.usertype == userArray[i].usertype) {
                    alert("Username đã tồn tại");
                    document.getElementById('username').focus();
                    return false;
                }
            }

            if (obj.username == "") {
                alert("Vui lòng nhập tên đăng kí");
                document.getElementById('username').focus();
                return false;
            }
            if (obj.password == "") {
                alert("Vui lòng nhập password");
                document.getElementById('password').focus();
                return false;
            }
            if (document.getElementById('passwordrp').value != obj.password) {
                alert("Password sai");
                document.getElementById('passwordrp').focus();
                return false;
            }
            if (obj.fullname == "") {
                alert("Vui lòng nhập họ tên");
                document.getElementById('fullname').focus();
                return false;
            }
            if (obj.email == "") {
                alert("Vui lòng nhập email");
                document.getElementById('email').focus();
                return false;
            }
            if (obj.phone == "") {
                alert("Vui lòng nhập số điện thoại");
                document.getElementById('phone').focus();
                return false;
            }
            if (obj.address == "") {
                alert("Vui lòng nhập địa chỉ");
                document.getElementById('address').focus();
                return false;
            }
            return true;
        }

        function checkttdn_1() { //Đăng nhập bằng tài khoản admin
            var x = 0;
            var userArray = JSON.parse(localStorage.getItem('user'));
            var username = document.getElementById('tendn').value;
            var password = document.getElementById('mk').value;
            for (var i = 0; i < userArray.length; i++) {
                if (userArray[i].username == username && userArray[i].password == password && userArray[i].usertype == "admin") { //Kiểm tra thông tin
                    window.location.assign("admin.html"); //Truy cập vào trang admin.html
                    alert("Truy cập thành công!");
                    x = 1;
                }
            }
            if (x == 0) alert("Hãy kiểm tra lại thông tin đăng nhập");
        }

        function checkttdn() { //Đăng nhập bằng tài khoản user
            var x = 0;
            localStorage.removeItem('buybyuser'); //Xóa vùng đệm lưu tên username đã login vào (Khi logout)
            var username = document.getElementById('tendn').value; //Lấy tt input
            var password = document.getElementById('mk').value; //Lấy tt input
            localStorage.removeItem('cart'); //Xóa hết thông tin giỏ hàng của khách khi logout khỏi account (Khi logout)
            if (localStorage.getItem('cart') == null) { //Tạo lại giỏ hàng khi login
                var cartarray = [];
                localStorage.setItem('cart', JSON.stringify(cartarray));
            }
            var userArray = JSON.parse(localStorage.getItem('user')); //Lấy tt tài khoản đã đăng kí vào
            var buyofuser = [];
            for (var i = 0; i < userArray.length; i++) {
                if (userArray[i].username == username && userArray[i].password == password && userArray[i].usertype == "member") { //Kiểm tra thông tin đăng nhập
                    if (localStorage.getItem('buybyuser') == null) {
                        buyofuser = [{ user: username }];
                        localStorage.setItem('buybyuser', JSON.stringify(buyofuser));
                    }
                    hideTK(); //Hiện username bên góc của web để thể hiện đối tượng nào đã login vào
                    alert("Đăng nhập thành công");
                    out(); //Thoát khỏi bảng đăng nhập
                    x = 1;
                } else if (userArray[i].username == username && userArray[i].password != password && userArray[i].usertype == "member") { //Kiểm tra sai mật khẩu
                    alert("Hãy kiểm tra lại mật khẩu");
                    return 0;
                }
            }
            if (x == 0) alert("Đăng nhập thất bại");
        }
        var dem = 0;

        function showtt() {
            if (dem == 0) {
                document.getElementById('dxbox').style.display = "block";
                dem++;
                return 0;
            }
            if (dem == 1) {
                document.getElementById('dxbox').style.display = "none";
                dem++;
                return 0;
            }
            if (dem == 2) {
                dem = 0;
                showtt();
            }
        }

        function hideTK() { //Hiện username
            if (localStorage.getItem('buybyuser') != null) {
                var userArray = JSON.parse(localStorage.getItem('buybyuser'));
                document.getElementById('tkkh').innerHTML = 'Username:<a href="#" onclick="showtt()"><u>' + userArray[0].user + '</u></a>';
            }
        }

        function dangxuat() {
            localStorage.removeItem('buybyuser');
            localStorage.removeItem('cart');
            window.location.assign('DOAN.html');
        }

        function CreateAccountBoard() {
            document.getElementById('logbox_2').style.zIndex = "10";
            document.getElementById('logbox_2').style.opacity = "1";
            document.getElementById('logbox').style.zIndex = "-1";
            document.getElementById('logbox').style.opacity = "0";
        }

        function out_2() {
            document.getElementById('logbox_2').style.opacity = "0";
            document.getElementById('logbox_2').style.zIndex = "-1";
            document.getElementById('wrapper').style.opacity = "1";
            document.getElementById('logbox_0').style.opacity = "0";
            document.getElementById('logbox_0').style.zIndex = "-1";
        }

        function dangnhap() {
            if (localStorage.getItem('buybyuser') != null) {
                alert("Bạn đã đăng nhập rồi !");
                return 0;
            }
            document.getElementById('wrapper').style.opacity = "0.2";
            document.getElementById('logbox').style.zIndex = "10";
            document.getElementById('logbox').style.opacity = "1";
            document.getElementById('logbox_2').style.opacity = "0";
            document.getElementById('logbox_2').style.zIndex = "-1";
            document.getElementById('logbox_0').style.zIndex = "8";
            document.getElementById('logbox_0').style.opacity = "0.2";
        }

        function out() {
            document.getElementById('logbox').style.opacity = "0";
            document.getElementById('logbox').style.zIndex = "-1";
            document.getElementById('wrapper').style.opacity = "1";
            document.getElementById('logbox_0').style.opacity = "0";
            document.getElementById('logbox_0').style.zIndex = "-1";
        }
        var sosptrentrang = 12;

        function resetall() {
            localStorage.removeItem('filter');
            document.getElementById("search-box").value = "";
            document.getElementById('slt1').value = ""; //Hiện ra các lựa chọn cho search nâng cao
            document.getElementById('slt2').value = "";
            document.getElementById('slt3').value = "";
        }

        function createPageSearch() {
            var s = "";
            var productarray = JSON.parse(localStorage.getItem('filter'));
            var tongsosp = (productarray.length); //Tính tổng số sản phẩm trong local filter
            var sotrang = tongsosp / sosptrentrang; //Tính số trang
            if (Math.ceil(sotrang) == 1) {
                document.getElementById('trang').innerHTML = s; //Nếu số trang bằng 1 thì không cần hiện số
            } else {
                for (var i = 0; i < Math.ceil(sotrang); i++) {
                    s += '<a  class="sp" href="#" onclick="chuyenPageSearch(' + (i + 1) + ')">' + (i + 1) + '</a>'; //Tạo thanh phân trang (các số để bấm)
                }

                document.getElementById('trang').innerHTML = s;
            }
        }

        function chuyenPageSearch(obj) {
            var vttrang = parseInt(obj);
            var s = "";
            var productarray = JSON.parse(localStorage.getItem('filter'));
            var vtbatdau = (sosptrentrang * vttrang) - sosptrentrang; //Tìm vị trí bắt đầu của sản phẩm dựa trên vị trí trang (obj là vị trí trang) VD:số trang là 1 ==> (12*1)-12=0 ==> lấy sản phẩm bắt đầu từ vị trí 0 của local filter
            for (var i = 0; i < sosptrentrang; i++) {
                if (!productarray[vtbatdau]) break; //Tránh lỗi inner lại các sản phẩm đã có khi trang chưa đủ 12 sản phẩm mà đã hết biến trong local filter
                s += '<a href="#" class="card" onclick="themVaoGioHang(' + productarray[vtbatdau].product + ')"><div style="position:absolute;color:black;margin-top:5px;margin-left:5px"><i>' + productarray[vtbatdau].brand + '<br>' + productarray[vtbatdau].product + '</i></div><div class="addtocart" style="font-size:20px;position:absolute;height:55px;width:100px;border-radius:20px;margin:40px 110px;background-color:orange;color:white">Add to Cart</div><img src="' + productarray[vtbatdau].img + '" style="width: 100%;height: 300px"/><div style="margin-top:10px;font-size:19px;color:black"><b>' + productarray[vtbatdau].name + '</b></div><div class="price" style="font-weight:bold;margin-top:0px;color:orange">' + productarray[vtbatdau].price + ' $</div></a>';
                vtbatdau++;
            }
            document.getElementById('ndu').innerHTML = s; //inner từng sản phẩm vào (kèm hình tên....)
        }

        function createPageSearch1() { //Tương tự như search cơ bản, nhưng lấy biến từ local filter2 (thông tin đã các sản phầm tìm đc qua search nâng cao)
            var s = "";
            var productarray = JSON.parse(localStorage.getItem('filter2'));
            var tongsosp = (productarray.length);
            var sotrang = tongsosp / sosptrentrang;
            if (Math.ceil(sotrang) == 1) {
                document.getElementById('trang').innerHTML = s;
            } else {
                for (var i = 0; i < Math.ceil(sotrang); i++) {
                    s += '<a  class="sp" href="#" onclick="chuyenPageSearch1(' + (i + 1) + ')">' + (i + 1) + '</a>';
                }

                document.getElementById('trang').innerHTML = s;
            }
        }

        function chuyenPageSearch1(obj) { //Tương tự như search cơ bản, nhưng lấy biến từ local filter2 (thông tin đã các sản phầm tìm đc qua search nâng cao)
            var vttrang = parseInt(obj);
            var s = "";
            var productarray = JSON.parse(localStorage.getItem('filter2'));
            var vtbatdau = (sosptrentrang * vttrang) - sosptrentrang;
            for (var i = 0; i < sosptrentrang; i++) {
                if (!productarray[vtbatdau]) break;
                s += '<a href="#" class="card" onclick="themVaoGioHang(' + productarray[vtbatdau].product + ')"><div style="position:absolute;color:black;margin-top:5px;margin-left:5px"><i>' + productarray[vtbatdau].brand + '<br>' + productarray[vtbatdau].product + '</i></div><div class="addtocart" style="font-size:20px;position:absolute;height:55px;width:100px;border-radius:20px;margin:40px 110px;background-color:orange;color:white">Add to Cart</div><img src="' + productarray[vtbatdau].img + '" style="width: 100%;height: 300px"/><div style="margin-top:10px;font-size:19px;color:black"><b>' + productarray[vtbatdau].name + '</b></div><div class="price" style="font-weight:bold;margin-top:0px;color:orange">' + productarray[vtbatdau].price + ' $</div></a>';
                vtbatdau++;
            }
            document.getElementById('ndu').innerHTML = s;
        }

        function searchFunction() { //Hàm search cơ bản
            var temp;
            document.getElementById('slt1').value = "";
            document.getElementById('slt2').value = "";
            document.getElementById('slt3').value = "";
            localStorage.removeItem('filter'); //Xóa localstorage của lọc thông tin sản phẩm lấy ra từ search
            var productarray = [];
            var input = document.getElementById("search-box");
            var filter = input.value.toUpperCase();
            var tempArr = JSON.parse(localStorage.getItem('products'));
            for (var i = 0; i < tempArr.length; i++) {
                temp = tempArr[i].name.toUpperCase();
                if (temp.indexOf(filter) > -1) { //Kiểm tra có sự xuất hiện của biến filter trong temp không
                    productarray.push(tempArr[i]);
                }
            }
            if (localStorage.getItem('filter') == null) {
                localStorage.setItem('filter', JSON.stringify(productarray)); //Lưu thông tin các sản phậm search được
            }
            createPageSearch(); //Tạo thanh phân trang của search
            chuyenPageSearch(1); //Hàm giúp chuyển page cho search
        }
        var pricetemp = "";
        var genderc = "";
        var brandc = "";

        function searchF(obj) { //Search nâng cao
            localStorage.removeItem('filter2');
            var productarray = [];
            var temp;
            var productarray1 = [];
            var tempArrs = JSON.parse(localStorage.getItem('products'));
            for (var i = 0; i < tempArrs.length; i++) {
                productarray1.push(tempArrs[i]);
            }
            if (localStorage.getItem('filter') == null) {
                localStorage.setItem('filter', JSON.stringify(productarray1)); //Lưu thông tin các sản phậm search được
            }
            var tempArr = JSON.parse(localStorage.getItem('filter'));
            var s = "";
            checkforFilter(obj); //Check giá trị của input r gán vào cái biến để lọc
            for (var i = 0; i < tempArr.length; i++) {
                if ((tempArr[i].gender == genderc && tempArr[i].brand == brandc) || (tempArr[i].gender == genderc && brandc == "") || (genderc == "" && tempArr[i].brand == brandc) || (genderc == "" && brandc == "")) { //Lọc theo giới tính, nhãn hàng
                    if (pricetemp == "") //Lọc theo khoảng giá
                        productarray.push(tempArr[i]);
                    if (pricetemp == "a")
                        if (tempArr[i].price < 110) {
                            productarray.push(tempArr[i]);
                        }
                    if (pricetemp == "c")
                        if (tempArr[i].price > 200) {
                            productarray.push(tempArr[i]);
                        }
                    if (pricetemp == "b")
                        if (tempArr[i].price >= 110 && tempArr[i].price <= 200) {
                            productarray.push(tempArr[i]);
                        }
                }
            }
            if (localStorage.getItem('filter2') == null) {
                localStorage.setItem('filter2', JSON.stringify(productarray));
            }
            createPageSearch1();
            chuyenPageSearch1(1);
        }

        function checkforFilter(obj) {
            switch (document.getElementById(obj).value) {
                case 'male':
                    genderc = "man";
                    break;
                case 'female':
                    genderc = "woman";
                    break;
                case 'kid':
                    genderc = "kid";
                    break;
                case 'ad':
                    brandc = "adidas";
                    break;
                case 'pu':
                    brandc = "puma";
                    break;
                case 'ni':
                    brandc = "nike";
                    break;
                case '110':
                    pricetemp = "a";
                    break;
                case '110200':
                    pricetemp = "b";
                    break;
                case '200':
                    pricetemp = "c";
                    break;
                case '':
                    if (obj == "slt3") pricetemp = "";
                    if (obj == "slt1") brandc = "";
                    if (obj == "slt2") genderc = "";
                    break;
                default:
                    break;
            }
        }



        function themVaoGioHang(obj) { //Thêm vào biến local giỏ hàng
            if (localStorage.getItem('buybyuser') == null) { //Phải đăng nhập mới có thể thêm vào giỏ hàng sản phẩm
                alert("Vui lòng đăng nhập trước!");
                return 0;
            }
            if (localStorage.getItem('cart') == null) {
                var cartarray = [];
                localStorage.setItem('cart', JSON.stringify(cartarray));
            }
            var tempArr = JSON.parse(localStorage.getItem('cart'));
            var temp = obj;
            var productArray = JSON.parse(localStorage.getItem('products'));
            for (var i = 0; i < productArray.length; i++) {
                if (temp == productArray[i].product) tempArr.push(productArray[i]);
            }
            localStorage.setItem('cart', JSON.stringify(tempArr));
            alert("Added to cart");
        }

        function chuyenPageFilter(obj) {
            var vttrang = parseInt(obj);
            var s = "";
            var productarray = JSON.parse(localStorage.getItem('arrBrand'));
            var vtbatdau = (sosptrentrang * vttrang) - sosptrentrang;
            for (var i = 0; i < sosptrentrang; i++) {
                if (!productarray[vtbatdau]) break;
                s += '<a href="#" class="card" onclick="themVaoGioHang(' + productarray[vtbatdau].product + ')"><div style="position:absolute;color:black;margin-top:5px;margin-left:5px"><i>' + productarray[vtbatdau].brand + '<br>' + productarray[vtbatdau].product + '</i></div><div class="addtocart" style="font-size:20px;position:absolute;height:55px;width:100px;border-radius:20px;margin:40px 110px;background-color:orange;color:white">Add to Cart</div><img src="' + productarray[vtbatdau].img + '" style="width: 100%;height: 300px"/><div style="margin-top:10px;font-size:19px;color:black"><b>' + productarray[vtbatdau].name + '</b></div><div class="price" style="font-weight:bold;margin-top:0px;color:orange">' + productarray[vtbatdau].price + ' $</div></a>';
                vtbatdau++;
            }
            document.getElementById('ndu').innerHTML = s;
        }

        function createPageFilter() {
            var s = "";
            var productarray = JSON.parse(localStorage.getItem('arrBrand'));
            var tongsosp = (productarray.length);
            var sotrang = tongsosp / sosptrentrang;
            if (Math.ceil(sotrang) == 1) {
                document.getElementById('trang').innerHTML = s;
            } else {
                for (var i = 0; i < Math.ceil(sotrang); i++) {
                    s += '<a  class="sp" href="#" onclick="chuyenPageFilter(' + (i + 1) + ')">' + (i + 1) + '</a>';
                }

                document.getElementById('trang').innerHTML = s;
            }
        }

        function chuyenPage() { //Hàm dùng để chuyển trang inner dữ liệu trang vào
            var url = window.location.href;
            var id = url.split('?');
            var idd = parseInt(id[1]); //cắt ra từ url để phân trang inner dữ liệu
            var s = "";
            var productarray = JSON.parse(localStorage.getItem('products'));
            var vtbatdau = (sosptrentrang * idd) - sosptrentrang;
            for (var i = 0; i < sosptrentrang; i++) {
                if (!productarray[vtbatdau]) break;
                s += '<a href="#" class="card" onclick="themVaoGioHang(' + productarray[vtbatdau].product + ')"><div style="position:absolute;color:black;margin-top:5px;margin-left:5px"><i>' + productarray[vtbatdau].brand + '<br>' + productarray[vtbatdau].product + '</i></div><div class="addtocart" style="font-size:20px;position:absolute;height:55px;width:100px;margin:40px 110px;border-radius:20px;background-color:orange;color:white">Add to Cart</div><img src="' + productarray[vtbatdau].img + '" style="width: 100%;height: 300px"/><div style="margin-top:10px;font-size:19px;color:black"><b>' + productarray[vtbatdau].name + '</b></div><div class="price" style="font-weight:bold;margin-top:0px;color:orange">' + productarray[vtbatdau].price + ' $</div></a>';
                vtbatdau++;
            }
            document.getElementById('ndu').innerHTML = s;
        }

        function createPage() { //Khởi tạo tính toán số trang và nút chuyển trang
            var s = "";
            var productarray = JSON.parse(localStorage.getItem('products'));
            var tongsosp = (productarray.length);
            var sotrang = tongsosp / sosptrentrang;
            if (Math.ceil(sotrang) == 1) { //Số trang =1 thì khỏi tạo nút bấm
                document.getElementById('trang').innerHTML = s;
            } else {
                for (var i = 0; i < Math.ceil(sotrang); i++) { //Math.ceil để làm tròn lên số trang
                    s += '<a  class="sp" href="content.html?' + (i + 1) + '" onclick="chuyenPage()">' + (i + 1) + '</a>';
                }

                document.getElementById('trang').innerHTML = s;
            }
        }





        function brand(obj) { //Lấy dữ liệu để lọc dữ liệu theo Brand
            var s = "";
            localStorage.removeItem('filter');
            document.getElementById("search-box").value = "";
            document.getElementById('slt1').value = ""; //Hiện ra các lựa chọn cho search nâng cao
            document.getElementById('slt2').value = "";
            document.getElementById('slt3').value = "";
            localStorage.removeItem("arrBrand"); //Xóa local để reset lại cho mỗi lần lọc
            var tempBrand = [];
            if (localStorage.getItem('arrBrand') == null) {
                tempBrand = [];
                localStorage.setItem('arrBrand', JSON.stringify(tempBrand));
            }
            var tempArr = JSON.parse(localStorage.getItem('arrBrand'));
            var brandname = obj;
            var productArray = JSON.parse(localStorage.getItem('products')); //Lấy dữ liệu từ local để check với local arrBrand
            for (var i = 0; i < productArray.length; i++)
                if (productArray[i].brand == brandname) {
                    tempArr.push(productArray[i]);
                }
            localStorage.setItem('arrBrand', JSON.stringify(tempArr));
            createPageFilter();
            chuyenPageFilter(1);
        }

        function gender(obj) { //Lấy dữ liệu để lọc dữ liệu theo Gender
            var s = "";
            localStorage.removeItem('filter');
            document.getElementById("search-box").value = "";
            document.getElementById('slt1').value = ""; //Hiện ra các lựa chọn cho search nâng cao
            document.getElementById('slt2').value = "";
            document.getElementById('slt3').value = "";
            localStorage.removeItem("arrBrand"); //Xóa local để reset lại cho mỗi lần lọc
            var tempBrand = [];
            if (localStorage.getItem('arrBrand') == null) {
                tempBrand = [];
                localStorage.setItem('arrBrand', JSON.stringify(tempBrand));
            }
            var tempArr = JSON.parse(localStorage.getItem('arrBrand'));
            var gender = obj;
            var productArray = JSON.parse(localStorage.getItem('products')); //Lấy dữ liệu từ local để check với local arrBrand
            for (var i = 0; i < productArray.length; i++)
                if (productArray[i].gender == gender) {
                    tempArr.push(productArray[i]);
                }
            localStorage.setItem('arrBrand', JSON.stringify(tempArr)); //Đẩy tempArr vào local arrBrand

            createPageFilter();
            chuyenPageFilter(1);

        }


        function pageAll() {
            createPage();
            chuyenPage();

        }
        function Fixproduct() {
            //Sửa thông tin một sản phẩm
            var xd = 0;
            var gtri = document.getElementById("change").value;
            var productArray = JSON.parse(localStorage.getItem("products"));
            var ID = document.getElementById("product_2").value;
            for (var i = 0; i < productArray.length; i++)
                if (ID == productArray[i].product) {
                    xd = 1;
                    switch (document.getElementById("choose").value) {
                        case "name": //Sửa tên sản phẩm
                            productArray[i].name = gtri;
                            break;
                        case "img": //Sửa hình ảnh
                            var cut = gtri.split("\\");
                            productArray[i].img = cut[2];
                            break;
                        case "price": //Sửa giá
                            productArray[i].price = gtri;
                            break;
                        case "brd": //Sửa hãng giày
                            productArray[i].brand = gtri;
                            break;
                        default:
                            break;
                    }
                }
            if (xd == 0) alert("ID sản phẩm không tồn tại");
            localStorage.setItem("products", JSON.stringify(productArray));
            alert("Sửa thành công");
            cancelbox(); //Đóng box chỉnh sửa sản phẩm
            document.getElementById("change").value = "";
            document.getElementById("choose").value = "";
            document.getElementById("capnhat").innerHTML =
                '<input readonly style="height:20px" type="text" id="change"/>';

            show(); //Reset lại trang
        }
        var addsp = 0;

        function hideAddSP() {
            if (addsp == 0) {
                document.getElementById("clearfix").style.display = "block";
                addsp++;
                return 0;
            }
            if (addsp == 1) {
                document.getElementById("clearfix").style.display = "none";
                addsp++;
                return 0;
            }
            if (addsp == 2) {
                addsp = 0;
                hideAddSP();
            }
        }

        function hideFixSP(obj) {
            document.getElementById("clearfix_2").style.display = "block";
            document.getElementById("flat").style.zIndex = "10";
            document.getElementById("flat").style.display = "block";
            document.getElementById("ttsp").innerHTML =
                "ID sản phẩm: <input style='text-align:center;font-size:18px;font-style:italic;' readonly id='product_2' value='" +
                obj +
                "'>";
            var productArray = JSON.parse(localStorage.getItem("products"));
            for (var i = 0; i < productArray.length; i++) {
                if (obj == productArray[i].product) {
                    document.getElementById("ttsp2").innerHTML =
                        "<img style='height:100px;width:100px' src='" +
                        productArray[i].img +
                        "'>";
                    document.getElementById("ttsp3").innerHTML =
                        "Tên sản phẩm: " + productArray[i].name;
                }
            }
        }

        function reset_1() {
            document.getElementById("product").value = "";
            document.getElementById("name").value = "";
            document.getElementById("brand").value = "";
            document.getElementById("gender").value = "";
            document.getElementById("imgg").value = "";
            document.getElementById("price").value = "";
        }

        function cancelbox() {
            document.getElementById("clearfix_2").style.display = "none";
            document.getElementById("flat").style.zIndex = "-1";
            document.getElementById("flat").style.display = "none";
            document.getElementById("change").value = "";
            document.getElementById("choose").value = "";
            document.getElementById("capnhat").innerHTML =
                '<input readonly style="height:20px" type="text" id="change"/>';
        }

        function changetype() {
            var gtri = document.getElementById("change").value;
            switch (document.getElementById("choose").value) {
                case "name":
                    document.getElementById("capnhat").innerHTML =
                        '<input style="height:20px" type="text" id="change"/>';
                    break;
                case "img":
                    document.getElementById("capnhat").innerHTML =
                        '<input style="height:20px" type="file" id="change"/>';
                    break;
                case "price":
                    document.getElementById("capnhat").innerHTML =
                        '<input style="height:20px" type="text" id="change"/>';
                    break;
                case "brd":
                    document.getElementById("capnhat").innerHTML =
                        '<input style="height:20px" type="text" id="change"/>';
                    break;
                default:
                    break;
            }
        }
    </script>
</head>

<body>
    <script>
        window.onload = function() {
            createAdmin();
            show();
        };
    </script>
    <div id="flat" style="
        background-color: black;
        position: fixed;
        width: 100%;
        height: 100%;
        opacity: 0.5;
        z-index: -1;
        display: none;
      "></div>
    <div id="clearfix_2" style="
        display: none;
        position: fixed;
        background-color: gray;
        text-align: center;
        padding: 50px;
        left: 40%;
        top: 30%;
        z-index: 11;
        border-radius: 20%;
      ">
        <div id="ttsp2"></div>
        <div id="ttsp3" style="color: white; font-size: 20px"></div>
        <div id="ttsp" style="color: white; font-size: 20px"></div>
        <div style="color: white; font-size: 20px; margin-top: 30px">
            Chọn đối tượng muốn sửa:
        </div>
        <select style="font-size: 18px" id="choose" onchange="changetype()">
        <option value="">Choose</option>
        <option value="name">Name</option>
        <option value="img">Image</option>
        <option value="price">Price</option>
        <option value="brd">Brand</option>
      </select>
        <div id="capnhat">
            <input readonly style="height: 20px" type="text" id="change" />
        </div>
        <div id="confirm" style="margin-top: 20px">
            <a href="#" style="
            float: left;
            background-color: white;
            text-decoration: none;
            font-weight: bold;
            padding: 10px;
          " onclick="Fixproduct()">XÁC NHẬN</a
        ><a
          href="#"
          style="
            background-color: white;
            text-decoration: none;
            font-weight: bold;
            padding: 10px;
            float: right;
          "
          onclick="cancelbox()"
          >CANCEL</a
        >
      </div>
    </div>
    <div id="nav" class="sidenav">
        <a class="logo" style="margin-left: 65px;font-size: 30px;">HOTEL</p></a>
        <a href="admindemo.html" class="icon-a"><i class="fa fa-dashboard icons"></i>&nbsp;&nbsp;DASHBOARD</a
      >
      <a href="sanphamdemo.html" class="icon-a"
        ><i class="fa fa-users icons"></i>&nbsp;&nbsp;MANAGING CUSTOMER</a
      >
      <a href="index.html" class="icon-a"
        ><i class="fa fa-file icons"></i>&nbsp;&nbsp;MANAGING RECEIPT</a
      >
      
    </div>
    <div
      id="boxtb"
      style="
        background-color: white;
        height: -100px;
        width: 500px;
        position: fixed;
        z-index: 10;
        right: 20%;
        display: flex;
      "
    ></div>
    <div id="shows">
      <div id="main">
        <div class="head">
          <div class="col-div-6">
            <span
              onclick="invinbox()"
              style="font-size: 30px; cursor: pointer; color: white"
              class="nav2"
              >&#9776;MANAGING CUSTOMER</span
            >
          </div>
          <a href="#" onclick="hideAddSP()"
            ><h3 style="color: white;clear: both;font-size: 30px;padding-top: 30px;">ADD NEW CUSTOMER>></h3></a
          >
          <div id="clearfix" style="display: none">
            <div style="color: white; font-size: 20px">ID:</div>
            <input style="height: 20px" type="number" id="product" />
            <div style="color: white; font-size: 20px">Name:</div>
            <input style="height: 20px" type="text" id="name" />

            <div style="color: white; font-size: 20px">Image:</div>
            <input style="height: 20px" type="file" id="imgg" />
            <div style="color: white; font-size: 20px">Price:</div>
            <input style="height: 20px" type="number" id="price" />
            <div style="color: white; font-size: 20px">Brand:</div>
            <select style="height: 20px" id="brand">
              <option value="">Choose</option>
              <option value="nike">Nike</option>
              <option value="puma">Puma</option>
              <option value="adidas">Adidas</option>
            </select>
            <div style="color: white; font-size: 20px">Gender:</div>
            <select style="height: 20px" id="gender">
              <option value="">Choose</option>
              <option value="man">Man</option>
              <option value="woman">Woman</option>
              <option value="kid">Kid</option>
            </select>
            <div style="margin-top: 20px">
              <a
                href="#"
                style="
                  background-color: white;
                  text-decoration: none;
                  font-weight: bold;
                  padding: 10px;
                  padding-left: 68px;
                  padding-right: 68px;
                "
                onclick="addproduct()"
                >THÊM</a
              >
            </div>
          </div>
        </div>
      </div>
      <div class="col-div-8">
        <div class="box-7">
          <div class="content-box">
            <input
              style="
                width: 95%;
                height: 40px;
                font-size: 15px;
                padding-left: 20px;
              "
              type="text"
              id="search-box"
              placeholder="searching..."
              onkeyup="filterOf()"
            />

            <table id="showlist"></table>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>